#!/bin/bash
#
# This script installs and configures my terminal tools.

# Parameters
author="Sahithyen Kanaganayagam <mail@sahithyen.com>"
dotfiles_repo="github.com/sahithyen/dotfiles"

# Print informations about the tool
echo "dotfiles/install ($author)"
echo "repo: $dotfiles_repo"

#
# start
#

# Change to base of the repository
cd "${0%/*}"

#
# Install packages
#

# Following packages are necessary:
#  * Git
#  * zsh
#  * tmux
#  * Neovim
#  * The Silver Searcher
#  * fzf
# TODO: check dependencies

#
# zsh
#

# Install oh-my-zsh
echo $HOME
export RUNZSH=no
sh <(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)

# Link configuration
if [[ -f $HOME/.zshrc ]]
then
  rm $HOME/.zshrc
fi

ln -s $HOME/.dotfiles/zsh/.zshrc $HOME/.zshrc

#
# tmux
#

# Link configuration
ln -s $HOME/.dotfiles/tmux/.tmux.conf $HOME/.tmux.conf

# Install tpm
tpm_path="$HOME/.tmux/plugins/tpm"
tpm_repo="https://github.com/tmux-plugins/tpm"

if [[ ! -e $tpm_path ]]
then
  git clone $tpm_repo $tpm_path
fi

#
# Neovim
#

# Link configuration
mkdir -p $HOME/.config/nvim
ln -s $HOME/.dotfiles/neovim/.config/nvim/init.vim $HOME/.config/nvim/init.vim

# Install vim-plug
vim_plug_path="$HOME/.local/share/nvim/site/autoload/plug.vim"
vim_plug_url="https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim"
if [[ ! -f $vim_plug_path ]]
then
  curl -fLo $vim_plug_path --create-dirs $vim_plug_url
fi

# Install plugins
nvim -c "PlugInstall" -c "qa!"

